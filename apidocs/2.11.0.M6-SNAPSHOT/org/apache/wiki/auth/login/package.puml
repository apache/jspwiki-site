@startuml

    namespace org.apache.wiki.auth.login {

        class UserDatabaseCallback [[UserDatabaseCallback.html]] {
            +getUserDatabase(): UserDatabase
            +setUserDatabase(UserDatabase): void
        }

        class UserDatabaseLoginModule [[UserDatabaseLoginModule.html]] {
            +login(): boolean
        }

        class AuthorizerCallback [[AuthorizerCallback.html]] {
            +setAuthorizer(Authorizer): void
            +getAuthorizer(): Authorizer
        }

        class WebContainerLoginModule [[WebContainerLoginModule.html]] {
            {static} #log: Logger
            +login(): boolean
        }

        class CookieAssertionLoginModule [[CookieAssertionLoginModule.html]] {
            {static} +PREFS_COOKIE_NAME: String
            {static} #log: Logger
            +login(): boolean
            {static} +getUserCookie(HttpServletRequest): String
            {static} +setUserCookie(HttpServletResponse, String): void
            {static} +clearUserCookie(HttpServletResponse): void
        }

        class HttpRequestCallback [[HttpRequestCallback.html]] {
            +setRequest(HttpServletRequest): void
            +getRequest(): HttpServletRequest
        }

        class WikiEngineCallback [[WikiEngineCallback.html]] {
            +setEngine(WikiEngine): void
            +getEngine(): WikiEngine
        }

        class CookieAuthenticationLoginModule [[CookieAuthenticationLoginModule.html]] {
            {static} #COOKIE_DIR: String
            {static} +PROP_LOGIN_EXPIRY_DAYS: String
            +login(): boolean
            {static} +setLoginCookie(WikiEngine, HttpServletResponse, String): void
            {static} +clearLoginCookie(WikiEngine, HttpServletRequest, HttpServletResponse): void
        }

        abstract class AbstractLoginModule [[AbstractLoginModule.html]] {
            {static} #NULL: String
            #m_options: Map<String, ?>
            #m_state: Map<String, ?>
            #m_subject: Subject
            +abort(): boolean
            +commit(): boolean
            +initialize(Subject, CallbackHandler, Map<String, ?>, Map<String, ?>): void
            +logout(): boolean
            {abstract} +login(): boolean
        }

        class WikiCallbackHandler [[WikiCallbackHandler.html]] {
            +WikiCallbackHandler(WikiEngine, HttpServletRequest, String, String)
            +handle(Callback[]): void
        }

        class PrincipalWrapper [[PrincipalWrapper.html]] {
            +PrincipalWrapper(Principal)
            +getName(): String
        }

        class WebContainerCallbackHandler [[WebContainerCallbackHandler.html]] {
            +WebContainerCallbackHandler(WikiEngine, HttpServletRequest)
            +handle(Callback[]): void
        }

        class AnonymousLoginModule [[AnonymousLoginModule.html]] {
            {static} +PROMPT: String
            {static} #log: Logger
            +login(): boolean
        }

        interface javax.security.auth.callback.Callback
        javax.security.auth.callback.Callback <|.. UserDatabaseCallback

        AbstractLoginModule <|-- UserDatabaseLoginModule

        javax.security.auth.callback.Callback <|.. AuthorizerCallback

        AbstractLoginModule <|-- WebContainerLoginModule

        AbstractLoginModule <|-- CookieAssertionLoginModule

        javax.security.auth.callback.Callback <|.. HttpRequestCallback

        javax.security.auth.callback.Callback <|.. WikiEngineCallback

        AbstractLoginModule <|-- CookieAuthenticationLoginModule

        interface javax.security.auth.spi.LoginModule {
            {abstract} +initialize(Subject, CallbackHandler, Map<String, ?>, Map<String, ?>): void
            {abstract} +login(): boolean
            {abstract} +commit(): boolean
            {abstract} +abort(): boolean
            {abstract} +logout(): boolean
        }
        javax.security.auth.spi.LoginModule <|.. AbstractLoginModule

        interface javax.security.auth.callback.CallbackHandler {
            {abstract} +handle(Callback[]): void
        }
        javax.security.auth.callback.CallbackHandler <|.. WikiCallbackHandler

        interface java.security.Principal {
            {abstract} +getName(): String
        }
        java.security.Principal <|.. PrincipalWrapper

        javax.security.auth.callback.CallbackHandler <|.. WebContainerCallbackHandler

        AbstractLoginModule <|-- AnonymousLoginModule

        AbstractLoginModule --> javax.security.auth.callback.CallbackHandler: m_handler

        AbstractLoginModule --> "*" java.security.Principal: m_principals

        PrincipalWrapper --> java.security.Principal: principal

    }


    center footer UMLDoclet 1.1.4, PlantUML 1.2019.05
@enduml
