breadcrumb={"url": "https://jspwiki.apache.org/development/", "name": "Development" }
status=published
title=Edit Website
type=page
~~~~~~
Apache JSPWiki website
----------------------
(adapted from [Apache Guacamole site](https://github.com/apache/incubator-guacamole-website))

This repository contains the source for the website of Apache JSPWiki, so it can be deployed via [gitpubsub](https://blogs.apache.org/infra/entry/git_based_websites_available) (see https://issues.apache.org/jira/browse/INFRA-13716)

The website itself is completely static, being automatically generated by [JBake](https://jbake.org/) prior to deployment. The content of the website is written in a mixture of Freemarker templates and Markdown. Templated content is interpreted only a build time, with the final result being completely static.

Table of contents
-----------------
* [Repository structure](#repository-structure)
* [Build prerequisites](#build-prerequisites)
* [Testing changes locally](#testing-changes-locally)
* [Publishing changes](#publishing-changes)

## Repository structure<a name="repository-structure"></a>

In addition to the `LICENSE` and `NOTICE` files required of any proper Apache-licensed project, the repository contains the following critical files:

* `./pom.xml`: to orchestrate the website build
* `./src/main/jbake/`: standard [jbake maven plugin structure](https://github.com/ingenieux/jbake-maven-plugin), contains three subdirectories:
    * `./src/main/jbake/assets/`: The assets directory is where you should place your static files such as images, CSS files and JavaScript files etc. These files are copied over to the baked output as is. You can create any directory structure you like in the assets directory and this structure will be maintained when copied.
    * `./src/main/jbake/content/`: holds content files, with the extension of these files determining what type of content it contains (i.e.: `.md` for [Markdown](http://daringfireball.net/projects/markdown/syntax), `.html` for raw HTML, etc.)
    * `./src/main/jbake/templates/`: holds templates files, with the extension of these files determining the templates engine (i.e.: `.ftl` for [Freemarker](https://freemarker.apache.org/), `.thyme` for [Thymeleaf](http://www.thymeleaf.org/), etc.)
* `./content/`: the actual content served for jspwiki.apache.org, see [publishing changes](#publishing-changes) below

## Build prerequisites<a name="build-prerequisites"></a>

The build needs at least Maven 3.1.1 and Java 7, thus these must be installed first.

## Testing changes locally<a name="testing-changes-locally"></a>

Just run `mvn clean jbake:inline` and the site will be accesible through http://localhost:8080. Changes will be reloaded on the fly. When done testing your local changes, press `Enter` to stop the web server and return to the shell.

## Publishing changes<a name="publishing-changes"></a>

Changes to the website are published using Apache's [gitpubsub](https://blogs.apache.org/infra/entry/git_based_websites_available) which relies on a special branch called "asf-site" containing *all website content* within a directory called `./content/`.

In the Apache JSPWiki website repository, the "asf-site" branch is an "orphan" branch. Updating the website thus involves:

1. Making and testing your changes locally
2. Replacing the entire contents of the `content/` directory within "asf-site"
   with the newly-generated `content/` directory.

On the `jbake` branch, run `mvn clean generate-resources` to generate the site under `./target/content/`. Move the site to the `./content/` directory on the `asf-site` branch and push the generated site there.

Keep in mind that the new content must be *staged* for and committed in this branch. Once you have verified that the staged content is as expected, commit your changes (along with a useful commit message describing the changes at a high level) using `git commit` and publish the update using `git push origin`.

If you wish to unstage your changes, use `git reset --hard HEAD` to return to the original state of "asf-site", wiping out any local modifications. You can then return to whichever branch you were working on with `git checkout`.

Use `ci.sh` on the `jbake` branch after executing `mvn clean generate-resources` to automate all this procedure.