<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>SpamFilter (Apache JSPWiki 2.12.2-SNAPSHOT API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.5.1.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="SpamFilter (Apache JSPWiki 2.12.2-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":10,"i5":9,"i6":10,"i7":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/SpamFilter.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.apache.wiki.filters</a></div>
<h2 title="Class SpamFilter" class="title">Class SpamFilter</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="../api/filters/BasePageFilter.html" title="class in org.apache.wiki.api.filters">org.apache.wiki.api.filters.BasePageFilter</a></li>
<li>
<ul class="inheritance">
<li>org.apache.wiki.filters.SpamFilter</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../api/filters/PageFilter.html" title="interface in org.apache.wiki.api.filters">PageFilter</a></code></dd>
</dl>
<hr>
<object type="image/svg+xml" data="SpamFilter.svg"  style="max-width:60%;float:right;"></object>
<pre style="white-space:pre-wrap;">public class <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.114">SpamFilter</a>
extends <a href="../api/filters/BasePageFilter.html" title="class in org.apache.wiki.api.filters">BasePageFilter</a></pre>
<div class="block">This is Herb, the JSPWiki spamfilter that can also do choke modifications.

  Parameters:
  <ul>
    <li>wordlist - Page name where the spamword regexps are found.  Use [{SET spamwords='regexp list separated with spaces'}] on
     that page.  Default is "SpamFilterWordList".
    <li>IPlist - Page name where the IP regexps are found.  Use [{SET ips='regexp list separated with spaces'}] on
     that page.  Default is "SpamFilterIPList".
    <li>maxpagenamelength - Maximum page name length. Default is 100.
    <li>blacklist - The name of an attachment containing the list of spam patterns, one per line. Default is
        "SpamFilterWordList/blacklist.txt"</li>
    <li>errorpage - The page to which the user is redirected.  Has a special variable $msg which states the reason. Default is "RejectedMessage".
    <li>pagechangesinminute - How many page changes are allowed/minute.  Default is 5.</li>
    <li>similarchanges - How many similar page changes are allowed before the host is banned.  Default is 2.  (since 2.4.72)</li>
    <li>bantime - How long an IP address stays on the temporary ban list (default is 60 for 60 minutes).</li>
    <li>maxurls - How many URLs can be added to the page before it is considered spam (default is 5)</li>
    <li>akismet-apikey - The Akismet API key (see akismet.org)</li>
    <li>ignoreauthenticated - If set to "true", all authenticated users are ignored and never caught in SpamFilter</li>
    <li>captcha - Sets the captcha technology to use.  Current allowed values are "none" and "asirra".</li>
    <li>strategy - Sets the filtering strategy to use.  If set to "eager", will stop at the first probable
        match, and won't consider any other tests.  This is the default, as it's considerably lighter. If set to "score", will go through all of the tests
        and calculates a score for the spam, which is then compared to a filter level value.
  </ul>

  <p>Please see the default editors/plain.jsp for examples on how the SpamFilter integrates
  with the editor system.</p>
  
  <p>Changes by admin users are ignored in any case.</p></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2.1.112</dd>
</dl>
</li>
</ul>
</div>
<div class="summary" style="clear:right;">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_AKISMET_API_KEY">PROP_AKISMET_API_KEY</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for specifying the Akismet API-key.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_ALLOWED_GROUPS">PROP_ALLOWED_GROUPS</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for specifying groups allowed to bypass the spam filter.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_BANTIME">PROP_BANTIME</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for specifying how long a host is banned.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_BLACKLIST">PROP_BLACKLIST</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for the attachment containing the blacklist.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_CAPTCHA">PROP_CAPTCHA</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for specifying which captcha technology should be used.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_ERRORPAGE">PROP_ERRORPAGE</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for the page to which you are directed if Herb rejects your edit.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_FILTERSTRATEGY">PROP_FILTERSTRATEGY</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for specifying which filter strategy should be used.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_IGNORE_AUTHENTICATED">PROP_IGNORE_AUTHENTICATED</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for specifying whether authenticated users should be ignored.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_IPLIST">PROP_IPLIST</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for specifying the page which contains the list of IPs to ban.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_MAX_PAGENAME_LENGTH">PROP_MAX_PAGENAME_LENGTH</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for specifying the maximum page name length.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_MAXURLS">PROP_MAXURLS</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for specifying how many URLs can any given edit contain.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_PAGECHANGES">PROP_PAGECHANGES</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for specifying how many changes is any given IP address
  allowed to do per minute.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_SIMILARCHANGES">PROP_SIMILARCHANGES</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for specifying how many similar changes are allowed before a host is banned.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PROP_WORDLIST">PROP_WORDLIST</a></span></code></th>
<td class="colLast">
<div class="block">The filter property name for specifying the page which contains the list of spamwords.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#STRATEGY_EAGER">STRATEGY_EAGER</a></span></code></th>
<td class="colLast">
<div class="block">The string specifying the "eager" strategy.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#STRATEGY_SCORE">STRATEGY_SCORE</a></span></code></th>
<td class="colLast">
<div class="block">The string specifying the "score" strategy.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="fields.inherited.from.class.org.apache.wiki.api.filters.BasePageFilter">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;org.apache.wiki.api.filters.<a href="../api/filters/BasePageFilter.html" title="class in org.apache.wiki.api.filters">BasePageFilter</a></h3>
<code><a href="../api/filters/BasePageFilter.html#m_engine">m_engine</a></code></li>
</ul>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">SpamFilter</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#checkHash(org.apache.wiki.api.core.Context,javax.servlet.jsp.PageContext)">checkHash</a></span>&#8203;(<a href="../api/core/Context.html" title="interface in org.apache.wiki.api.core">Context</a>&nbsp;context,
         javax.servlet.jsp.PageContext&nbsp;pageContext)</code></th>
<td class="colLast">
<div class="block">This method checks if the hash value is still valid, i.e. if it exists at all.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getBotFieldName()">getBotFieldName</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns a static string which can be used to detect spambots which just wildly fill in all the fields.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getHashFieldName(javax.servlet.http.HttpServletRequest)">getHashFieldName</a></span>&#8203;(javax.servlet.http.HttpServletRequest&nbsp;request)</code></th>
<td class="colLast">
<div class="block">Returns the name of the hash field to be used in this request.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getSpamHash(org.apache.wiki.api.core.Page,javax.servlet.http.HttpServletRequest)">getSpamHash</a></span>&#8203;(<a href="../api/core/Page.html" title="interface in org.apache.wiki.api.core">Page</a>&nbsp;page,
           javax.servlet.http.HttpServletRequest&nbsp;request)</code></th>
<td class="colLast">
<div class="block">This method is used to calculate an unique code when submitting the page to detect edit conflicts.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initialize(org.apache.wiki.api.core.Engine,java.util.Properties)">initialize</a></span>&#8203;(<a href="../api/core/Engine.html" title="interface in org.apache.wiki.api.core">Engine</a>&nbsp;engine,
          java.util.Properties&nbsp;properties)</code></th>
<td class="colLast">
<div class="block">If you override this, you should call super.initialize() first.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#insertInputFields(javax.servlet.jsp.PageContext)">insertInputFields</a></span>&#8203;(javax.servlet.jsp.PageContext&nbsp;pageContext)</code></th>
<td class="colLast">
<div class="block">This helper method adds all the input fields to your editor that the SpamFilter requires
 to check for spam.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isValidUserProfile(org.apache.wiki.api.core.Context,org.apache.wiki.auth.user.UserProfile)">isValidUserProfile</a></span>&#8203;(<a href="../api/core/Context.html" title="interface in org.apache.wiki.api.core">Context</a>&nbsp;context,
                  <a href="../auth/user/UserProfile.html" title="interface in org.apache.wiki.auth.user">UserProfile</a>&nbsp;profile)</code></th>
<td class="colLast">
<div class="block">Checks whether the UserProfile matches certain checks.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#preSave(org.apache.wiki.api.core.Context,java.lang.String)">preSave</a></span>&#8203;(<a href="../api/core/Context.html" title="interface in org.apache.wiki.api.core">Context</a>&nbsp;context,
       java.lang.String&nbsp;content)</code></th>
<td class="colLast">
<div class="block">This method is called before the page has been saved to the PageProvider.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.org.apache.wiki.api.filters.PageFilter">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.apache.wiki.api.filters.<a href="../api/filters/PageFilter.html" title="interface in org.apache.wiki.api.filters">PageFilter</a></h3>
<code><a href="../api/filters/PageFilter.html#destroy(org.apache.wiki.api.core.Engine)">destroy</a>, <a href="../api/filters/PageFilter.html#postSave(org.apache.wiki.api.core.Context,java.lang.String)">postSave</a>, <a href="../api/filters/PageFilter.html#postTranslate(org.apache.wiki.api.core.Context,java.lang.String)">postTranslate</a>, <a href="../api/filters/PageFilter.html#preTranslate(org.apache.wiki.api.core.Context,java.lang.String)">preTranslate</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="PROP_WORDLIST">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_WORDLIST</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.134">PROP_WORDLIST</a></pre>
<div class="block">The filter property name for specifying the page which contains the list of spamwords. Value is <tt>"wordlist"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_WORDLIST">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_IPLIST">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_IPLIST</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.137">PROP_IPLIST</a></pre>
<div class="block">The filter property name for specifying the page which contains the list of IPs to ban. Value is <tt>"IPlist"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_IPLIST">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_MAX_PAGENAME_LENGTH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_MAX_PAGENAME_LENGTH</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.140">PROP_MAX_PAGENAME_LENGTH</a></pre>
<div class="block">The filter property name for specifying the maximum page name length.  Value is <tt>"maxpagenamelength"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_MAX_PAGENAME_LENGTH">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_ERRORPAGE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_ERRORPAGE</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.143">PROP_ERRORPAGE</a></pre>
<div class="block">The filter property name for the page to which you are directed if Herb rejects your edit.  Value is <tt>"errorpage"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_ERRORPAGE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_PAGECHANGES">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_PAGECHANGES</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.148">PROP_PAGECHANGES</a></pre>
<div class="block">The filter property name for specifying how many changes is any given IP address
  allowed to do per minute.  Value is <tt>"pagechangesinminute"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_PAGECHANGES">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_SIMILARCHANGES">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_SIMILARCHANGES</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.151">PROP_SIMILARCHANGES</a></pre>
<div class="block">The filter property name for specifying how many similar changes are allowed before a host is banned.  Value is <tt>"similarchanges"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_SIMILARCHANGES">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_BANTIME">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_BANTIME</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.154">PROP_BANTIME</a></pre>
<div class="block">The filter property name for specifying how long a host is banned.  Value is <tt>"bantime"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_BANTIME">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_BLACKLIST">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_BLACKLIST</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.157">PROP_BLACKLIST</a></pre>
<div class="block">The filter property name for the attachment containing the blacklist.  Value is <tt>"blacklist"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_BLACKLIST">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_MAXURLS">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_MAXURLS</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.160">PROP_MAXURLS</a></pre>
<div class="block">The filter property name for specifying how many URLs can any given edit contain. Value is <tt>"maxurls"</tt></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_MAXURLS">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_AKISMET_API_KEY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_AKISMET_API_KEY</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.163">PROP_AKISMET_API_KEY</a></pre>
<div class="block">The filter property name for specifying the Akismet API-key.  Value is <tt>"akismet-apikey"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_AKISMET_API_KEY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_IGNORE_AUTHENTICATED">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_IGNORE_AUTHENTICATED</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.166">PROP_IGNORE_AUTHENTICATED</a></pre>
<div class="block">The filter property name for specifying whether authenticated users should be ignored. Value is <tt>"ignoreauthenticated"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_IGNORE_AUTHENTICATED">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_ALLOWED_GROUPS">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_ALLOWED_GROUPS</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.169">PROP_ALLOWED_GROUPS</a></pre>
<div class="block">The filter property name for specifying groups allowed to bypass the spam filter. Value is <tt>"jspwiki.filters.spamfilter.allowedgroups"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_ALLOWED_GROUPS">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_CAPTCHA">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_CAPTCHA</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.172">PROP_CAPTCHA</a></pre>
<div class="block">The filter property name for specifying which captcha technology should be used. Value is <tt>"captcha"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_CAPTCHA">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="PROP_FILTERSTRATEGY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_FILTERSTRATEGY</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.175">PROP_FILTERSTRATEGY</a></pre>
<div class="block">The filter property name for specifying which filter strategy should be used.  Value is <tt>"strategy"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.PROP_FILTERSTRATEGY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="STRATEGY_EAGER">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>STRATEGY_EAGER</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.178">STRATEGY_EAGER</a></pre>
<div class="block">The string specifying the "eager" strategy. Value is <tt>"eager"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.STRATEGY_EAGER">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a id="STRATEGY_SCORE">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>STRATEGY_SCORE</h4>
<pre>public static final&nbsp;java.lang.String <a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.181">STRATEGY_SCORE</a></pre>
<div class="block">The string specifying the "score" strategy. Value is <tt>"score"</tt>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.filters.SpamFilter.STRATEGY_SCORE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>SpamFilter</h4>
<pre>public&nbsp;<a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.114">SpamFilter</a>()</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="initialize(org.apache.wiki.api.core.Engine,java.util.Properties)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initialize</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;<a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.249">initialize</a>&#8203;(<a href="../api/core/Engine.html" title="interface in org.apache.wiki.api.core">Engine</a>&nbsp;engine,
                       java.util.Properties&nbsp;properties)</pre>
<div class="block">If you override this, you should call super.initialize() first.

 Is called whenever the a new PageFilter is instantiated and reset.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../api/filters/PageFilter.html#initialize(org.apache.wiki.api.core.Engine,java.util.Properties)">initialize</a></code>&nbsp;in interface&nbsp;<code><a href="../api/filters/PageFilter.html" title="interface in org.apache.wiki.api.filters">PageFilter</a></code></dd>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../api/filters/BasePageFilter.html#initialize(org.apache.wiki.api.core.Engine,java.util.Properties)">initialize</a></code>&nbsp;in class&nbsp;<code><a href="../api/filters/BasePageFilter.html" title="class in org.apache.wiki.api.filters">BasePageFilter</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>engine</code> - The Engine which owns this PageFilter</dd>
<dd><code>properties</code> - The properties ripped from filters.xml.</dd>
</dl>
</li>
</ul>
<a id="preSave(org.apache.wiki.api.core.Context,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>preSave</h4>
<pre class="methodSignature">public&nbsp;java.lang.String&nbsp;<a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.309">preSave</a>&#8203;(<a href="../api/core/Context.html" title="interface in org.apache.wiki.api.core">Context</a>&nbsp;context,
                                java.lang.String&nbsp;content)
                         throws <a href="../api/exceptions/RedirectException.html" title="class in org.apache.wiki.api.exceptions">RedirectException</a></pre>
<div class="block">This method is called before the page has been saved to the PageProvider.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>context</code> - The WikiContext</dd>
<dd><code>content</code> - The wikimarkup that the user just wanted to save.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The modified wikimarkup. Default implementation returns the markup as received.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../api/exceptions/RedirectException.html" title="class in org.apache.wiki.api.exceptions">RedirectException</a></code></dd>
</dl>
</li>
</ul>
<a id="getBotFieldName()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBotFieldName</h4>
<pre class="methodSignature">public static&nbsp;java.lang.String&nbsp;<a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.595">getBotFieldName</a>()</pre>
<div class="block">Returns a static string which can be used to detect spambots which just wildly fill in all the fields.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A string</dd>
</dl>
</li>
</ul>
<a id="isValidUserProfile(org.apache.wiki.api.core.Context,org.apache.wiki.auth.user.UserProfile)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isValidUserProfile</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.915">isValidUserProfile</a>&#8203;(<a href="../api/core/Context.html" title="interface in org.apache.wiki.api.core">Context</a>&nbsp;context,
                                  <a href="../auth/user/UserProfile.html" title="interface in org.apache.wiki.auth.user">UserProfile</a>&nbsp;profile)</pre>
<div class="block">Checks whether the UserProfile matches certain checks.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>profile</code> - The profile to check</dd>
<dd><code>context</code> - The WikiContext</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>False, if this userprofile is suspect and should not be allowed to be added.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2.6.1</dd>
</dl>
</li>
</ul>
<a id="getSpamHash(org.apache.wiki.api.core.Page,javax.servlet.http.HttpServletRequest)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSpamHash</h4>
<pre class="methodSignature">public static&nbsp;java.lang.String&nbsp;<a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.937">getSpamHash</a>&#8203;(<a href="../api/core/Page.html" title="interface in org.apache.wiki.api.core">Page</a>&nbsp;page,
                                           javax.servlet.http.HttpServletRequest&nbsp;request)</pre>
<div class="block">This method is used to calculate an unique code when submitting the page to detect edit conflicts.  
  It currently incorporates the last-modified date of the page, and the IP address of the submitter.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>page</code> - The WikiPage under edit</dd>
<dd><code>request</code> - The HTTP Request</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A hash value for this page and session</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2.6</dd>
</dl>
</li>
</ul>
<a id="getHashFieldName(javax.servlet.http.HttpServletRequest)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getHashFieldName</h4>
<pre class="methodSignature">public static&nbsp;java.lang.String&nbsp;<a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.956">getHashFieldName</a>&#8203;(javax.servlet.http.HttpServletRequest&nbsp;request)</pre>
<div class="block">Returns the name of the hash field to be used in this request. The value is unique per session, and once 
  the session has expired, you cannot edit anymore.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>request</code> - The page request</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The name to be used in the hash field</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2.6</dd>
</dl>
</li>
</ul>
<a id="checkHash(org.apache.wiki.api.core.Context,javax.servlet.jsp.PageContext)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkHash</h4>
<pre class="methodSignature">public static&nbsp;boolean&nbsp;<a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.991">checkHash</a>&#8203;(<a href="../api/core/Context.html" title="interface in org.apache.wiki.api.core">Context</a>&nbsp;context,
                                javax.servlet.jsp.PageContext&nbsp;pageContext)
                         throws java.io.IOException</pre>
<div class="block">This method checks if the hash value is still valid, i.e. if it exists at all. This can occur in two cases: 
  either this is a spam bot which is not adaptive, or it is someone who has been editing one page for too long, 
  and their session has expired.
  <p>
  This method puts a redirect to the http response field to page "SessionExpired" and logs the incident in 
  the spam log (it may or may not be spam, but it's rather likely that it is).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>context</code> - The WikiContext</dd>
<dd><code>pageContext</code> - The JSP PageContext.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>True, if hash is okay.  False, if hash is not okay, and you need to redirect.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If redirection fails</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2.6</dd>
</dl>
</li>
</ul>
<a id="insertInputFields(javax.servlet.jsp.PageContext)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>insertInputFields</h4>
<pre class="methodSignature">public static&nbsp;java.lang.String&nbsp;<a href="../../../../src-html/org/apache/wiki/filters/SpamFilter.html#line.1014">insertInputFields</a>&#8203;(javax.servlet.jsp.PageContext&nbsp;pageContext)</pre>
<div class="block">This helper method adds all the input fields to your editor that the SpamFilter requires
 to check for spam.  This <i>must</i> be in your editor form if you intend to use the SpamFilter.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pageContext</code> - The PageContext</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A HTML string which contains input fields for the SpamFilter.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/SpamFilter.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright (c) 2001-2023 The Apache Software Foundation. All rights reserved.</small></p>
</footer>
</body>
</html>