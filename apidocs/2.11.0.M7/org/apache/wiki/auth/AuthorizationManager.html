<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="es">
<head>
<!-- Generated by javadoc (15) on Mon Dec 14 21:04:57 CET 2020 -->
<title>AuthorizationManager (Apache JSPWiki 2.11.0.M7 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2020-12-14">
<meta name="description" content="declaration: package: org.apache.wiki.auth, interface: AuthorizationManager">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var data = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":18,"i5":6,"i6":18,"i7":6,"i8":6,"i9":18,"i10":6,"i11":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],16:["t5","Default Methods"]};
var altColor = "alt-color";
var rowColor = "row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar.top">
<div class="skip-nav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar.top.firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/AuthorizationManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip.navbar.top">
<!--   -->
</span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.wiki.auth</a></div>
<h1 title="Interface AuthorizationManager" class="title">Interface AuthorizationManager</h1>
</div>
<section class="description">
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code><a href="../api/engine/Initializable.html" title="interface in org.apache.wiki.api.engine">Initializable</a></code></dd>
</dl>
<dl class="notes">
<dt>All Known Implementing Classes:</dt>
<dd><code><a href="DefaultAuthorizationManager.html" title="class in org.apache.wiki.auth">DefaultAuthorizationManager</a></code></dd>
</dl>
<hr>
<object type="image/svg+xml" data="AuthorizationManager.svg"  style="max-width:60%;float:right;"></object>
<pre style="white-space:pre-wrap;">public interface <a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.60">AuthorizationManager</a>
extends <a href="../api/engine/Initializable.html" title="interface in org.apache.wiki.api.engine">Initializable</a></pre>
<div class="block"><p>Manages all access control and authorization; determines what authenticated users are allowed to do.</p>
 <p>Privileges in JSPWiki are expressed as Java-standard <a href="https://docs.oracle.com/javase/8/docs/api/java/security/Permission.html" title="class or interface in java.security" class="external-link"><code>Permission</code></a> classes. There are two types of permissions:</p>
 <ul>
   <li><a href="permissions/WikiPermission.html" title="class in org.apache.wiki.auth.permissions"><code>WikiPermission</code></a> - privileges that apply to an entire wiki instance: <em>e.g.,</em>
   editing user profiles, creating pages, creating groups</li>
   <li><a href="permissions/PagePermission.html" title="class in org.apache.wiki.auth.permissions"><code>PagePermission</code></a> - privileges that apply to a single wiki page or range of pages:
   <em>e.g.,</em> reading, editing, renaming
 </ul>
 <p>Calling classes determine whether they are entitled to perform a particular action by constructing the appropriate permission first,
 then passing it and the current <a href="../api/core/Session.html" title="interface in org.apache.wiki.api.core"><code>Session</code></a> to the <a href="#checkPermission(org.apache.wiki.api.core.Session,java.security.Permission)"><code>checkPermission(Session, Permission)</code></a> method. If
 the session's Subject possesses the permission, the action is allowed.</p>
 <p>For WikiPermissions, the decision criteria is relatively simple: the caller either possesses the permission, as granted by the wiki
 security policy -- or not.</p>
 <p>For PagePermissions, the logic is exactly the same if the page being checked does not have an access control list. However, if the
 page does have an ACL, the authorization decision is made based the <em>union</em> of the permissions granted in the ACL and in the
 security policy. In other words, the user must be named in the ACL (or belong to a group or role that is named in the ACL) <em>and</em>
 be granted (at least) the same permission in the security policy. We do this to prevent a user from gaining more permissions than they
 already have, based on the security policy.</p>
 <p>See the implementation on <a href="#checkPermission(org.apache.wiki.api.core.Session,java.security.Permission)"><code>checkPermission(Session, Permission)</code></a> method for more information on the authorization logic.</p></div>
<dl class="notes">
<dt>Since:</dt>
<dd>2.3</dd>
<dt>See Also:</dt>
<dd><a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth"><code>AuthenticationManager</code></a></dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field.summary">
<h2>Field Summary</h2>
<div class="member-summary">
<table class="summary-table">
<caption><span>Fields</span></caption>
<thead>
<tr>
<th class="col-first" scope="col">Modifier and Type</th>
<th class="col-second" scope="col">Field</th>
<th class="col-last" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="alt-color">
<td class="col-first"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#DEFAULT_AUTHORIZER">DEFAULT_AUTHORIZER</a></span></code></th>
<td class="col-last">
<div class="block">The default external Authorizer is the <a href="authorize/WebContainerAuthorizer.html" title="class in org.apache.wiki.auth.authorize"><code>WebContainerAuthorizer</code></a></div>
</td>
</tr>
<tr class="row-color">
<td class="col-first"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#DEFAULT_POLICY">DEFAULT_POLICY</a></span></code></th>
<td class="col-last">
<div class="block">Name of the default security policy file, in WEB-INF.</div>
</td>
</tr>
<tr class="alt-color">
<td class="col-first"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#POLICY">POLICY</a></span></code></th>
<td class="col-last">
<div class="block">Property that supplies the security policy file name, in WEB-INF.</div>
</td>
</tr>
<tr class="row-color">
<td class="col-first"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#PROP_AUTHORIZER">PROP_AUTHORIZER</a></span></code></th>
<td class="col-last">
<div class="block">The property name in jspwiki.properties for specifying the external <a href="Authorizer.html" title="interface in org.apache.wiki.auth"><code>Authorizer</code></a>.</div>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method.summary">
<h2>Method Summary</h2>
<div class="member-summary" id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="active-table-tab">All Methods</button><button role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="table-tab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t3" class="table-tab" onclick="show(4);">Abstract Methods</button><button role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t5" class="table-tab" onclick="show(16);">Default Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<table class="summary-table" aria-labelledby="t0">
<thead>
<tr>
<th class="col-first" scope="col">Modifier and Type</th>
<th class="col-second" scope="col">Method</th>
<th class="col-last" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="alt-color" id="i0">
<td class="col-first"><code>void</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#addWikiEventListener(org.apache.wiki.event.WikiEventListener)">addWikiEventListener</a></span>&#8203;(<a href="../event/WikiEventListener.html" title="interface in org.apache.wiki.event">WikiEventListener</a>&nbsp;listener)</code></th>
<td class="col-last">
<div class="block">Registers a WikiEventListener with this instance.</div>
</td>
</tr>
<tr class="row-color" id="i1">
<td class="col-first"><code>boolean</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#allowedByLocalPolicy(java.security.Principal%5B%5D,java.security.Permission)">allowedByLocalPolicy</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Principal.html" title="class or interface in java.security" class="external-link">Principal</a>[]&nbsp;principals,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Permission.html" title="class or interface in java.security" class="external-link">Permission</a>&nbsp;permission)</code></th>
<td class="col-last">
<div class="block">Checks to see if the local security policy allows a particular static Permission.</div>
</td>
</tr>
<tr class="alt-color" id="i2">
<td class="col-first"><code>boolean</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#checkPermission(org.apache.wiki.api.core.Session,java.security.Permission)">checkPermission</a></span>&#8203;(<a href="../api/core/Session.html" title="interface in org.apache.wiki.api.core">Session</a>&nbsp;session,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Permission.html" title="class or interface in java.security" class="external-link">Permission</a>&nbsp;permission)</code></th>
<td class="col-last">
<div class="block">Returns <code>true</code> or <code>false</code>, depending on whether a Permission is allowed for the Subject associated with
 a supplied Session.</div>
</td>
</tr>
<tr class="row-color" id="i3">
<td class="col-first"><code>boolean</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#checkStaticPermission(org.apache.wiki.api.core.Session,java.security.Permission)">checkStaticPermission</a></span>&#8203;(<a href="../api/core/Session.html" title="interface in org.apache.wiki.api.core">Session</a>&nbsp;session,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Permission.html" title="class or interface in java.security" class="external-link">Permission</a>&nbsp;permission)</code></th>
<td class="col-last">
<div class="block">Determines whether a Subject possesses a given "static" Permission as defined in the security policy file.</div>
</td>
</tr>
<tr class="alt-color" id="i4">
<td class="col-first"><code>default void</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#fireEvent(int,java.security.Principal,java.lang.Object)">fireEvent</a></span>&#8203;(int&nbsp;type,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Principal.html" title="class or interface in java.security" class="external-link">Principal</a>&nbsp;user,
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;permission)</code></th>
<td class="col-last">
<div class="block">Fires a WikiSecurityEvent of the provided type, user, and permission to all registered listeners.</div>
</td>
</tr>
<tr class="row-color" id="i5">
<td class="col-first"><code><a href="Authorizer.html" title="interface in org.apache.wiki.auth">Authorizer</a></code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#getAuthorizer()">getAuthorizer</a></span>()</code></th>
<td class="col-last">
<div class="block">Returns the current external <a href="Authorizer.html" title="interface in org.apache.wiki.auth"><code>Authorizer</code></a> in use.</div>
</td>
</tr>
<tr class="alt-color" id="i6">
<td class="col-first"><code>default boolean</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#hasAccess(org.apache.wiki.api.core.Context,javax.servlet.http.HttpServletResponse)">hasAccess</a></span>&#8203;(<a href="../api/core/Context.html" title="interface in org.apache.wiki.api.core">Context</a>&nbsp;context,
javax.servlet.http.HttpServletResponse&nbsp;response)</code></th>
<td class="col-last">
<div class="block">Checks whether the current user has access to the wiki context, by obtaining the required Permission (<a href="../api/core/Command.html#requiredPermission()"><code>Command.requiredPermission()</code></a>)
 and delegating the access check to <a href="#checkPermission(org.apache.wiki.api.core.Session,java.security.Permission)"><code>checkPermission(Session, Permission)</code></a>.</div>
</td>
</tr>
<tr class="row-color" id="i7">
<td class="col-first"><code>boolean</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#hasAccess(org.apache.wiki.api.core.Context,javax.servlet.http.HttpServletResponse,boolean)">hasAccess</a></span>&#8203;(<a href="../api/core/Context.html" title="interface in org.apache.wiki.api.core">Context</a>&nbsp;context,
javax.servlet.http.HttpServletResponse&nbsp;response,
boolean&nbsp;redirect)</code></th>
<td class="col-last">
<div class="block">Checks whether the current user has access to the wiki context (and
 optionally redirects if not), by obtaining the required Permission (<a href="../api/core/Command.html#requiredPermission()"><code>Command.requiredPermission()</code></a>)
 and delegating the access check to <a href="#checkPermission(org.apache.wiki.api.core.Session,java.security.Permission)"><code>checkPermission(Session, Permission)</code></a>.</div>
</td>
</tr>
<tr class="alt-color" id="i8">
<td class="col-first"><code>boolean</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#hasRoleOrPrincipal(org.apache.wiki.api.core.Session,java.security.Principal)">hasRoleOrPrincipal</a></span>&#8203;(<a href="../api/core/Session.html" title="interface in org.apache.wiki.api.core">Session</a>&nbsp;session,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Principal.html" title="class or interface in java.security" class="external-link">Principal</a>&nbsp;principal)</code></th>
<td class="col-last">
<div class="block">Determines if the Subject associated with a supplied Session contains a desired user Principal or built-in Role principal,
 OR is a member a Group or external Role.</div>
</td>
</tr>
<tr class="row-color" id="i9">
<td class="col-first"><code>default boolean</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#isUserInRole(org.apache.wiki.api.core.Session,java.security.Principal)">isUserInRole</a></span>&#8203;(<a href="../api/core/Session.html" title="interface in org.apache.wiki.api.core">Session</a>&nbsp;session,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Principal.html" title="class or interface in java.security" class="external-link">Principal</a>&nbsp;principal)</code></th>
<td class="col-last">
<div class="block">Determines if the Subject associated with a supplied Session contains a desired Role or GroupPrincipal.</div>
</td>
</tr>
<tr class="alt-color" id="i10">
<td class="col-first"><code>void</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#removeWikiEventListener(org.apache.wiki.event.WikiEventListener)">removeWikiEventListener</a></span>&#8203;(<a href="../event/WikiEventListener.html" title="interface in org.apache.wiki.event">WikiEventListener</a>&nbsp;listener)</code></th>
<td class="col-last">
<div class="block">Un-registers a WikiEventListener with this instance.</div>
</td>
</tr>
<tr class="row-color" id="i11">
<td class="col-first"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/security/Principal.html" title="class or interface in java.security" class="external-link">Principal</a></code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#resolvePrincipal(java.lang.String)">resolvePrincipal</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name)</code></th>
<td class="col-last">
<div class="block">Given a supplied string representing a Principal's name from an Acl, this method resolves the correct type of Principal (role,
 group, or user).</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inherited-list">
<h3 id="methods.inherited.from.class.org.apache.wiki.api.engine.Initializable">Methods inherited from interface&nbsp;org.apache.wiki.api.engine.<a href="../api/engine/Initializable.html" title="interface in org.apache.wiki.api.engine">Initializable</a></h3>
<code><a href="../api/engine/Initializable.html#initialize(org.apache.wiki.api.core.Engine,java.util.Properties)">initialize</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field.detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="DEFAULT_AUTHORIZER">
<h3>DEFAULT_AUTHORIZER</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.63">DEFAULT_AUTHORIZER</a></span></div>
<div class="block">The default external Authorizer is the <a href="authorize/WebContainerAuthorizer.html" title="class in org.apache.wiki.auth.authorize"><code>WebContainerAuthorizer</code></a></div>
<dl class="notes">
<dt>See Also:</dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.auth.AuthorizationManager.DEFAULT_AUTHORIZER">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="POLICY">
<h3>POLICY</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.66">POLICY</a></span></div>
<div class="block">Property that supplies the security policy file name, in WEB-INF.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.auth.AuthorizationManager.POLICY">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="DEFAULT_POLICY">
<h3>DEFAULT_POLICY</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.69">DEFAULT_POLICY</a></span></div>
<div class="block">Name of the default security policy file, in WEB-INF.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.auth.AuthorizationManager.DEFAULT_POLICY">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="PROP_AUTHORIZER">
<h3>PROP_AUTHORIZER</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.72">PROP_AUTHORIZER</a></span></div>
<div class="block">The property name in jspwiki.properties for specifying the external <a href="Authorizer.html" title="interface in org.apache.wiki.auth"><code>Authorizer</code></a>.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd><a href="../../../../constant-values.html#org.apache.wiki.auth.AuthorizationManager.PROP_AUTHORIZER">Constant Field Values</a></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method.detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="checkPermission(org.apache.wiki.api.core.Session,java.security.Permission)">
<h3>checkPermission</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.104">checkPermission</a></span>&#8203;(<span class="parameters"><a href="../api/core/Session.html" title="interface in org.apache.wiki.api.core">Session</a>&nbsp;session,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Permission.html" title="class or interface in java.security" class="external-link">Permission</a>&nbsp;permission)</span></div>
<div class="block">Returns <code>true</code> or <code>false</code>, depending on whether a Permission is allowed for the Subject associated with
 a supplied Session. The access control algorithm works this way:
 <ol>
 <li>The <a href="../api/core/Acl.html" title="interface in org.apache.wiki.api.core"><code>Acl</code></a> for the page is obtained</li>
 <li>The Subject associated with the current <a href="../api/core/Session.html" title="interface in org.apache.wiki.api.core"><code>Session</code></a> is obtained</li>
 <li>If the Subject's Principal set includes the Role Principal that is the administrator group, always allow the Permission</li>
 <li>For all permissions, check to see if the Permission is allowed according to the default security policy. If it isn't, deny
 the permission and halt further processing.</li>
 <li>If there is an Acl, get the list of Principals assigned this Permission in the Acl: these will be role, group or user Principals,
 or <a href="acl/UnresolvedPrincipal.html" title="class in org.apache.wiki.auth.acl"><code>UnresolvedPrincipal</code></a>s (see below). Then iterate through the Subject's Principal set and determine
 whether the user (Subject) possesses any one of these specified Roles or Principals.</li>
 </ol>
 <p>
 Note that when iterating through the Acl's list of authorized Principals, it is possible that one or more of the Acl's Principal
 entries are of type <code>UnresolvedPrincipal</code>. This means that the last time the ACL was read, the Principal (user, built-in
 Role, authorizer Role, or wiki Group) could not be resolved: the Role was not valid, the user wasn't found in the UserDatabase, or
 the Group wasn't known to (e.g., cached) in the GroupManager. If an <code>UnresolvedPrincipal</code> is encountered, this method
 will attempt to resolve it first <em>before</em> checking to see if the Subject possesses this principal, by calling
 <a href="#resolvePrincipal(java.lang.String)"><code>resolvePrincipal(String)</code></a>. If the (re-)resolution does not succeed, the access check for the principal will fail by
 definition (the Subject should never contain UnresolvedPrincipals).
 </p>
 <p>
 If security not set to JAAS, will return true.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>session</code> - the current wiki session</dd>
<dd><code>permission</code> - the Permission being checked</dd>
<dt>Returns:</dt>
<dd>the result of the Permission check</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isUserInRole(org.apache.wiki.api.core.Session,java.security.Principal)">
<h3>isUserInRole</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.120">isUserInRole</a></span>&#8203;(<span class="parameters"><a href="../api/core/Session.html" title="interface in org.apache.wiki.api.core">Session</a>&nbsp;session,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Principal.html" title="class or interface in java.security" class="external-link">Principal</a>&nbsp;principal)</span></div>
<div class="block"><p>Determines if the Subject associated with a supplied Session contains a desired Role or GroupPrincipal. The algorithm
 simply checks to see if the Subject possesses the Role or GroupPrincipal it in its Principal set. Note that any user (anonymous,
 asserted, authenticated) can possess a built-in role. But a user <em>must</em> be authenticated to possess a role other than one
 of the built-in ones. We do this to prevent privilege escalation.</p>
 <p>For all other cases, this method returns <code>false</code>.</p>
 <p>Note that this method does <em>not</em> consult the external Authorizer or GroupManager; it relies on the Principals that
 have been injected into the user's Subject at login time, or after group creation/modification/deletion.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>session</code> - the current wiki session, which must be non-null. If null, the result of this method always returns <code>false</code></dd>
<dd><code>principal</code> - the Principal (role or group principal) to look for, which must be non-<code>null</code>. If <code>null</code>,
                  the result of this method always returns <code>false</code></dd>
<dt>Returns:</dt>
<dd><code>true</code> if the Subject supplied with the WikiContext posesses the Role or GroupPrincipal, <code>false</code> otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getAuthorizer()">
<h3>getAuthorizer</h3>
<div class="member-signature"><span class="return-type"><a href="Authorizer.html" title="interface in org.apache.wiki.auth">Authorizer</a></span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.144">getAuthorizer</a></span>()
                  throws <span class="exceptions"><a href="WikiSecurityException.html" title="class in org.apache.wiki.auth">WikiSecurityException</a></span></div>
<div class="block">Returns the current external <a href="Authorizer.html" title="interface in org.apache.wiki.auth"><code>Authorizer</code></a> in use. This method is guaranteed to return a properly-initialized Authorizer, unless
 it could not be initialized. In that case, this method throws a <a href="WikiSecurityException.html" title="class in org.apache.wiki.auth"><code>WikiSecurityException</code></a>.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the current Authorizer</dd>
<dt>Throws:</dt>
<dd><code><a href="WikiSecurityException.html" title="class in org.apache.wiki.auth">WikiSecurityException</a></code> - if the Authorizer could not be initialized</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="hasRoleOrPrincipal(org.apache.wiki.api.core.Session,java.security.Principal)">
<h3>hasRoleOrPrincipal</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.164">hasRoleOrPrincipal</a></span>&#8203;(<span class="parameters"><a href="../api/core/Session.html" title="interface in org.apache.wiki.api.core">Session</a>&nbsp;session,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Principal.html" title="class or interface in java.security" class="external-link">Principal</a>&nbsp;principal)</span></div>
<div class="block"><p>Determines if the Subject associated with a supplied Session contains a desired user Principal or built-in Role principal,
 OR is a member a Group or external Role. The rules are as follows:</p>
 <ol>
 <li>First, if desired Principal is a Role or GroupPrincipal, delegate to <a href="#isUserInRole(org.apache.wiki.api.core.Session,java.security.Principal)"><code>isUserInRole(Session, Principal)</code></a> and
 return the result.</li>
 <li>Otherwise, we're looking for a user Principal, so iterate through the Principal set and see if any share the same name as the
 one we are looking for.</li>
 </ol>
 <p><em>Note: if the Principal parameter is a user principal, the session must be authenticated in order for the user to "possess it".
 Anonymous or asserted sessions will never posseess a named user principal.</em></p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>session</code> - the current wiki session, which must be non-null. If null, the result of this method always returns <code>false</code></dd>
<dd><code>principal</code> - the Principal (role, group, or user principal) to look for, which must be non-null. If null, the result of this
                  method always returns <code>false</code></dd>
<dt>Returns:</dt>
<dd><code>true</code> if the Subject supplied with the WikiContext posesses the Role, GroupPrincipal or desired
         user Principal, <code>false</code> otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="hasAccess(org.apache.wiki.api.core.Context,javax.servlet.http.HttpServletResponse)">
<h3>hasAccess</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.178">hasAccess</a></span>&#8203;(<span class="parameters"><a href="../api/core/Context.html" title="interface in org.apache.wiki.api.core">Context</a>&nbsp;context,
javax.servlet.http.HttpServletResponse&nbsp;response)</span>
                   throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Checks whether the current user has access to the wiki context, by obtaining the required Permission (<a href="../api/core/Command.html#requiredPermission()"><code>Command.requiredPermission()</code></a>)
 and delegating the access check to <a href="#checkPermission(org.apache.wiki.api.core.Session,java.security.Permission)"><code>checkPermission(Session, Permission)</code></a>. If the user is allowed, this method returns
 <code>true</code>; <code>false</code> otherwise. If access is allowed, the wiki context will be added to the request as an attribute
 with the key name <a href="../api/core/Context.html#ATTR_CONTEXT"><code>Context.ATTR_CONTEXT</code></a>. Note that this method will automatically redirect the user to
 a login or error page, as appropriate, if access fails. This is NOT guaranteed to be default behavior in the future.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>context</code> - wiki context to check if it is accesible</dd>
<dd><code>response</code> - the http response</dd>
<dt>Returns:</dt>
<dd>the result of the access check</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - In case something goes wrong</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="hasAccess(org.apache.wiki.api.core.Context,javax.servlet.http.HttpServletResponse,boolean)">
<h3>hasAccess</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.196">hasAccess</a></span>&#8203;(<span class="parameters"><a href="../api/core/Context.html" title="interface in org.apache.wiki.api.core">Context</a>&nbsp;context,
javax.servlet.http.HttpServletResponse&nbsp;response,
boolean&nbsp;redirect)</span>
           throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Checks whether the current user has access to the wiki context (and
 optionally redirects if not), by obtaining the required Permission (<a href="../api/core/Command.html#requiredPermission()"><code>Command.requiredPermission()</code></a>)
 and delegating the access check to <a href="#checkPermission(org.apache.wiki.api.core.Session,java.security.Permission)"><code>checkPermission(Session, Permission)</code></a>.
 If the user is allowed, this method returns <code>true</code>;
 <code>false</code> otherwise. Also, the wiki context will be added to the request as attribute
 with the key name <a href="../api/core/Context.html#ATTR_CONTEXT"><code>Context.ATTR_CONTEXT</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>context</code> - wiki context to check if it is accesible</dd>
<dd><code>response</code> - The servlet response object</dd>
<dd><code>redirect</code> - If true, makes an automatic redirect to the response</dd>
<dt>Returns:</dt>
<dd>the result of the access check</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code> - If something goes wrong</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="allowedByLocalPolicy(java.security.Principal[],java.security.Permission)">
<h3>allowedByLocalPolicy</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.206">allowedByLocalPolicy</a></span>&#8203;(<span class="parameters"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/Principal.html" title="class or interface in java.security" class="external-link">Principal</a>[]&nbsp;principals,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Permission.html" title="class or interface in java.security" class="external-link">Permission</a>&nbsp;permission)</span></div>
<div class="block">Checks to see if the local security policy allows a particular static Permission.
 Do not use this method for normal permission checks; use <a href="#checkPermission(org.apache.wiki.api.core.Session,java.security.Permission)"><code>checkPermission(Session, Permission)</code></a> instead.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>principals</code> - the Principals to check</dd>
<dd><code>permission</code> - the Permission</dd>
<dt>Returns:</dt>
<dd>the result</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="checkStaticPermission(org.apache.wiki.api.core.Session,java.security.Permission)">
<h3>checkStaticPermission</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.221">checkStaticPermission</a></span>&#8203;(<span class="parameters"><a href="../api/core/Session.html" title="interface in org.apache.wiki.api.core">Session</a>&nbsp;session,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Permission.html" title="class or interface in java.security" class="external-link">Permission</a>&nbsp;permission)</span></div>
<div class="block">Determines whether a Subject possesses a given "static" Permission as defined in the security policy file. This method uses standard
 Java 2 security calls to do its work. Note that the current access control context's <code>codeBase</code> is effectively <em>this
 class</em>, not that of the caller. Therefore, this method will work best when what matters in the policy is <em>who</em> makes the
 permission check, not what the caller's code source is. Internally, this method works by executing <code>Subject.doAsPrivileged</code>
 with a privileged action that simply calls <a href="https://docs.oracle.com/javase/8/docs/api/java/security/AccessController.html#checkPermission(java.security.Permission)" title="class or interface in java.security" class="external-link"><code>AccessController.checkPermission(Permission)</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>session</code> - the Session whose permission status is being queried</dd>
<dd><code>permission</code> - the Permission the Subject must possess</dd>
<dt>Returns:</dt>
<dd><code>true</code> if the Subject possesses the permission, <code>false</code> otherwise</dd>
<dt>See Also:</dt>
<dd><a href="https://docs.oracle.com/javase/8/docs/api/java/security/AccessController.html#checkPermission(java.security.Permission)" title="class or interface in java.security" class="external-link"><code>. A caught exception (or lack thereof) determines whether the
       privilege is absent (or present).</code></a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="resolvePrincipal(java.lang.String)">
<h3>resolvePrincipal</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/security/Principal.html" title="class or interface in java.security" class="external-link">Principal</a></span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.238">resolvePrincipal</a></span>&#8203;(<span class="parameters"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name)</span></div>
<div class="block"><p>Given a supplied string representing a Principal's name from an Acl, this method resolves the correct type of Principal (role,
 group, or user). This method is guaranteed to always return a Principal. The algorithm is straightforward:</p>
 <ol>
 <li>If the name matches one of the built-in <a href="authorize/Role.html" title="class in org.apache.wiki.auth.authorize"><code>Role</code></a> names, return that built-in Role</li>
 <li>If the name matches one supplied by the current <a href="Authorizer.html" title="interface in org.apache.wiki.auth"><code>Authorizer</code></a>, return that Role</li>
 <li>If the name matches a group managed by the current <a href="authorize/GroupManager.html" title="interface in org.apache.wiki.auth.authorize"><code>GroupManager</code></a>, return that Group</li>
 <li>Otherwise, assume that the name represents a user principal. Using the current <a href="user/UserDatabase.html" title="interface in org.apache.wiki.auth.user"><code>UserDatabase</code></a>,
 find the first user who matches the supplied name by calling <a href="user/UserDatabase.html#find(java.lang.String)"><code>UserDatabase.find(String)</code></a>.</li>
 <li>Finally, if a user cannot be found, manufacture and return a generic <a href="acl/UnresolvedPrincipal.html" title="class in org.apache.wiki.auth.acl"><code>UnresolvedPrincipal</code></a></li>
 </ol></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>name</code> - the name of the Principal to resolve</dd>
<dt>Returns:</dt>
<dd>the fully-resolved Principal</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="addWikiEventListener(org.apache.wiki.event.WikiEventListener)">
<h3>addWikiEventListener</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.248">addWikiEventListener</a></span>&#8203;(<span class="parameters"><a href="../event/WikiEventListener.html" title="interface in org.apache.wiki.event">WikiEventListener</a>&nbsp;listener)</span></div>
<div class="block">Registers a WikiEventListener with this instance.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>listener</code> - the event listener</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="removeWikiEventListener(org.apache.wiki.event.WikiEventListener)">
<h3>removeWikiEventListener</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.255">removeWikiEventListener</a></span>&#8203;(<span class="parameters"><a href="../event/WikiEventListener.html" title="interface in org.apache.wiki.event">WikiEventListener</a>&nbsp;listener)</span></div>
<div class="block">Un-registers a WikiEventListener with this instance.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>listener</code> - the event listener</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="fireEvent(int,java.security.Principal,java.lang.Object)">
<h3>fireEvent</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="member-name"><a href="../../../../src-html/org/apache/wiki/auth/AuthorizationManager.html#line.265">fireEvent</a></span>&#8203;(<span class="parameters">int&nbsp;type,
<a href="https://docs.oracle.com/javase/8/docs/api/java/security/Principal.html" title="class or interface in java.security" class="external-link">Principal</a>&nbsp;user,
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;permission)</span></div>
<div class="block">Fires a WikiSecurityEvent of the provided type, user, and permission to all registered listeners.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>type</code> - the event type to be fired</dd>
<dd><code>user</code> - the user associated with the event</dd>
<dd><code>permission</code> - the permission the subject must possess</dd>
<dt>See Also:</dt>
<dd><a href="../event/WikiSecurityEvent.html" title="class in org.apache.wiki.event"><code>WikiSecurityEvent</code></a></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottom-nav" id="navbar.bottom">
<div class="skip-nav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar.bottom.firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/AuthorizationManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<span class="skip-nav" id="skip.navbar.bottom">
<!--   -->
</span></nav>
<p class="legal-copy"><small>Copyright Â© 2001-2020 The Apache Software Foundation. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>