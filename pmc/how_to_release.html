<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html id="top" xmlns="http://www.w3.org/1999/xhtml" xmlns:jspwiki="http://www.jspwiki.org"><head>
  <base href="https://jspwiki.apache.org"></base>
  <title>How to Release</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" type="text/css" media="screen, projection, print" href="/css/jspwiki.css">
  <link rel="stylesheet" type="text/css" media="print" href="/css/jspwiki_print.css">
  <link rel="alternate stylesheet" type="text/css" href="/css/jspwiki_print.css" title="Print friendly">
  <link rel="alternate stylesheet" type="text/css" href="/css/jspwiki.css" title="Standard">
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
  <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
</head>
<body class="view">
<div id="wikibody" class="fav-left">
  <div id="header">
    <!-- <div class="titlebox"></div> -->
    <div class="applicationlogo"> 
      <a href="">Main</a>
    </div>

    <div class="companylogo"></div>
  
    <div class="userbox">
      <a href="http://www.apache.org" alt="Apache Software Foundation">
        <img src="/images/apache_software_foundation_logo.png" alt="Apache Software Foundation" id="asf-logo" style="width: 93px; height: 45px;">
      </a>
      <div class="clearbox"></div>
    </div>

    <div class="pagename">
      How to Release
    </div>
    
    <div class="breadcrumbs"><a href="https://jspwiki.apache.org">JSPWiki</a> &raquo; <a href="https://jspwiki.apache.org/pmc/">PMC</a> </div>
  </div>

  <div id="content">
    <div id="page">
      <div id="actionsTop" class="pageactions"> 
      <ul>
        <li>
          <a href="http://www.apache.org/foundation/" class="action edit" accesskey="f" title="The Foundation [f]">
            <span class="accesskey">F</span>oundation
          </a>
        </li>
        <li>
          <a href="http://projects.apache.org" class="action edit" accesskey="p" title="The Projects [p]">
            <span class="accesskey">P</span>rojects
          </a>
        </li>
        <li>
          <a href="http://people.apache.org" class="action edit" accesskey="e" title="The People [e]">
            P<span class="accesskey">e</span>ople
          </a>
        </li>
        <li>
          <a href="http://www.apache.org/foundation/getinvolved.html" class="action edit" accesskey="i" title="Get Involved [i]">
            Get <span class="accesskey">I</span>nvolved
          </a>
        </li>
        <li>
          <a title="Download [ d ]" class="action edit" accesskey="d" href="http://www.apache.org/dyn/closer.cgi">
            <span class="accesskey">D</span>ownload
          </a>
        </li>
        <li href="#" id="morebutton">
          <a href="http://www.apache.org/foundation/sponsorship.html" accesskey="s" class="action edit" title="Support Apache [ s ]">
            <span class="accesskey">S</span>upport Apache&nbsp;
          </a>
        </li>
      </ul>
      </div>

      <div class="tabmenu">
        <a class="activetab" id="menu-pagecontent" accesskey="J" href="/index.html">
          <span class="accesskey">J</span>SPWiki&nbsp;
        </a>
        <!-- <a id="menu-attach" accesskey="a"><span class="accesskey">A</span>ttach</a>
        <a id="menu-info" href="http://www.jspwiki.org/PageInfo.jsp?page=Main" accesskey="i"><span class="accesskey">I</span>nfo</a> -->
      </div>
      
      <div class="tabs">
        <div id="pagecontent">
          <h2>How to Release<a name="how-to-release"></a></h2>
<ul>
  <li><a href="#how-to-release">How to Release</a></li>
  <li><a href="#tldr">tl;dr</a></li>
  <li><a href="#first-time-release-managers">First time release managers</a></li>
  <li><a href="#create-a-release-candidate">Create a release candidate</a>
    <ul>
      <li><a href="#generate-release-candidate-artifacts">Generate release candidate artifacts</a></li>
      <li><a href="#prepare-the-release">Prepare the release</a></li>
    </ul>
  </li>
  <li><a href="#run-a-vote">Run a vote</a></li>
  <li><a href="#roll-out">Roll Out</a></li>
  <li><a href="#announce-the-release">Announce the release</a></li>
  <li><a href="#add-the-next-release-version-to-jira">Add the next release version to JIRA</a></li>
  <li><a href="#troubleshooting">Troubleshooting</a></li>
  <li><a href="#other-links-of-interest">Other links of interest</a></li>
</ul>
<h2>tl;dr<a name="tldr"></a></h2>
<p>Once you've done your first release, you'd most probably be more comfortable with the quick guide to get the release out (nevertheless, all steps are explained below):</p>
<ol>
  <li>
    <p>Prepare the release</p>
    <pre><code>mvn clean install apache-rat:rat -Papache-release               # generates artifacts, checks for AL headers
mvn release:prepare -DdryRun=true -DautoVersionSubmodules=true  # review pom.xml, confirm only appropiate sections have been changed
mvn deploy -Papache-release                                     # deploy a snapshot
mvn release:clean                                               # prepare the release 1/3
mvn release:prepare -DautoVersionSubmodules=true                # prepare the release 2/3
mvn release:perform                                             # prepare the release 3/3
</code></pre>
  </li>
  <li>
  <p>Close the staging repo</p></li>
  <li>
  <p>Svn copy binaries and source to <a href="https://dist.apache.org/repos/dist/dev/jspwiki/X.Y.Z/">https://dist.apache.org/repos/dist/dev/jspwiki/X.Y.Z/</a></p></li>
  <li>
  <p>Run the vote and, if successful, continue with the items on the list</p></li>
  <li>
  <p>Publish Nexus repository</p></li>
  <li>
  <p>Publish binaries and source to the <a href="http://www.apache.org/dev/mirrors.html">mirrors</a></p></li>
  <li>
  <p>Publish latest javadocs</p></li>
  <li>
  <p>Wait for 24 hours, then announce the release</p></li>
  <li>
  <p>Add the next release version to JIRA</p></li>
</ol>
<h2>First time release managers<a name="first-time-release-managers"></a></h2>
<ol>
  <li>
  <p>Generate <a href="http://www.apache.org/dev/release-signing.html#generate">PGP code signing keys</a></p></li>
  <li>
  <p>Add the PGP code signing keys to the <a href="http://svn.apache.org/repos/asf/jspwiki/dist/KEYS">KEYS file</a> as documented on the <a href="http://www.apache.org/dev/release-signing.html#keys-policy">Infrastructure site</a></p></li>
  <li>
  <p>Put in a <a href="https://issues.apache.org/jira/browse/INFRA">Infrastructure JIRA</a> asking to get added to the jspwiki unix group on <code>people.apache.org</code></p></li>
  <li>
  <p>Copy the modified KEYS file to the release folder <code>/www/www.apache.org/dist/jspwiki</code> on <code>people.apache.org</code> and ensure it has <code>0664</code> permissions.</p></li>
  <li>
    <p>Add the following <code>servers</code> to your Maven <code>settings.xml</code> file:</p>
    <pre><code>&lt;servers&gt;
  &lt;server&gt;
    &lt;id&gt;apache.releases.https&lt;/id&gt;
    &lt;username&gt;APACHE-ID&lt;/username&gt;
    &lt;password&gt;APACHE-PASSWORD&lt;/password&gt;
  &lt;/server&gt;
  &lt;server&gt;
    &lt;id&gt;apache.snapshots.https&lt;/id&gt;
    &lt;username&gt;APACHE-ID&lt;/username&gt;
    &lt;password&gt;APACHE-PASSWORD&lt;/password&gt;
  &lt;/server&gt;
  &lt;server&gt;
    &lt;id&gt;svn.apache.org&lt;/id&gt;
    &lt;username&gt;APACHE-ID&lt;/username&gt;
    &lt;password&gt;APACHE-PASSWORD&lt;/password&gt;
  &lt;/server&gt;
&lt;/servers&gt;
</code></pre>
  </li>
</ol>
<p>Note that your password doesn't need to be inside the <code>settings.xml</code> file, due to <a href="http://maven.apache.org/guides/mini/guide-encryption.html">Maven encryption capabilities</a>. It is also convenient to <a href="http://www.thegeekstuff.com/2008/11/3-steps-to-perform-ssh-login-without-password-using-ssh-keygen-ssh-copy-id/">setup the ssh keys</a> on <code>people.apache.org</code>, otherwise you'll have to enter your login password a number of times.</p>
<h2>Create a release candidate<a name="create-a-release-candidate"></a></h2>
<h3>Generate release candidate artifacts<a name="generate-release-candidate-artifacts"></a></h3>
<ol>
  <li>
    <p><strong>Generate artifacts</strong></p>
    <pre><code>mvn clean install apache-rat:rat -Papache-release
</code></pre>
    <p>This will check that all files have AL headers and also build artifacts, sources and sign</p>
  </li>
  <li>
    <p><strong>Check <code>POMs</code> for release</strong></p>
    <pre><code>mvn release:prepare -DdryRun=true -DautoVersionSubmodules=true 
</code></pre>
    <p>Perform quick diffs between <code>pom.xml</code> files and their sibling <code>pom.xml.tag</code> files to see if the license or any other info has been removed (should never happen, but just to stay on the safe side).</p>
  </li>
</ol>
<h3>Prepare the release<a name="prepare-the-release"></a></h3>
<ol>
  <li>
    <p><strong>Publish a snapshot</strong></p>
    <pre><code>mvn deploy -Papache-release
</code></pre>
  </li>
  <li>
    <p><strong>Prepare the release</strong></p>
    <pre><code>mvn release:clean
mvn release:prepare -DautoVersionSubmodules=true 
</code></pre>
  </li>
  <li>
    <p><strong>Stage the release for a vote</strong></p>
    <pre><code>mvn release:perform
</code></pre>
  </li>
  <li>
    <p><strong>Close the staging repository</strong></p>
    <ol>
      <li>
      <p>Login to <a href="https://repository.apache.org">https://repository.apache.org</a> and select Staging Repositories on the left under Build Promotion.</p></li>
      <li>
      <p>Select org.apache.jspwiki from the list of repositories, then click <a href="https://docs.sonatype.org/display/Repository/Closing+a+Staging+Repository">Close</a> using "Apache JSPWiki X.Y.Z" as the description to allow others to see the repository.</p></li>
    </ol>
  </li>
  <li>
    <p>**Svn copy binaries and source to <a href="https://dist.apache.org/repos/dist/dev/jspwiki/X.Y.Z/**">https://dist.apache.org/repos/dist/dev/jspwiki/X.Y.Z/**</a>, suggested structure</p>
    <pre><code>binaries
    portable
    webapp
source
wikipages        
</code></pre>
  </li>
</ol>
<h2>Run a vote<a name="run-a-vote"></a></h2>
<ol>
  <li>Send the following to <a href="mailto:d&#101;&#x76;&#64;&#x6a;s&#112;wi&#107;&#x69;&#x2e;a&#x70;&#x61;&#99;&#x68;e&#46;o&#x72;&#103;">d&#101;&#x76;&#64;&#x6a;s&#112;wi&#107;&#x69;&#x2e;a&#x70;&#x61;&#99;&#x68;e&#46;o&#x72;&#103;</a>:
    <pre><code>Subject: [VOTE] Release JSPWiki version X.Y.Z

This is a release vote for Apache JSPWiki, version X.Y.Z. The vote will be open for at least 72 hours from now.

It fixes the following issues:
https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12310732&amp;version=&lt;REPLACE&gt;

Note that we are voting upon the source (tag), binaries are provided for convenience.

Everybody is encouraged to vote.

Source and binary files:
http://people.apache.org/~&lt;REPLACE&gt;/jspwiki-X.Y.Z-candidate-$RC

Nexus staging repo: https://repository.apache.org/content/repositories/orgapachejspwiki-...

The tag to be voted upon:
http://svn.apache.org/repos/asf/jspwiki/tags/release-X.Y.Z/

JSPWiki&#39;s KEYS file containing PGP keys we use to sign the release:
http://www.apache.org/dist/jspwiki/KEYS

*** Please download, test and vote:

[ ] +1 Approve the release
[ ]  0 Don&#39;t mind
[ ] -1 Disapprove the release (please provide specific comments)
</code></pre>
  </li>
</ol>
<p>Note that the PMC needs to vote upon the release before any release can be made official.</p>
<h2>Roll Out<a name="roll-out"></a></h2>
<p>If the vote passes, roll out the release:</p>
<ol>
  <li>
    <p><strong>Publish Nexus repository</strong></p>
    <ol>
      <li>
      <p>Login to <a href="https://repository.apache.org">https://repository.apache.org</a> and select Staging Repositories on the left under Build Promotion.</p></li>
      <li>
      <p>Select the repository that was closed earlier, and click Release, using the description "Apache JSPWiki X.Y.Z"</p></li>
    </ol>
  </li>
  <li>
    <p><strong>Publish src and bin distributions to the <a href="http://www.apache.org/dev/mirrors.html">mirrors</a></strong></p>
    <ol>
      <li>
      <p><code>svn checkout</code> <a href="https://dist.apache.org/repos/dist/release/jspwiki">https://dist.apache.org/repos/dist/release/jspwiki</a></p></li>
      <li>
      <p><code>svn copy</code> the release artifacts from <code>https://dist.apache.org/repos/dist/dev/jspwiki/$VERSION-CANDIDATE</code> to <code>https://dist.apache.org/repos/dist/release/jspwiki/$VERSION</code></p></li>
      <li>
      <p><code>svn delete</code> older releases</p></li>
    </ol>
  </li>
  <li>
    <p><strong>Publish javadocs on jspwiki.apache.org</strong></p>
    <ol>
      <li>
      <p><code>svn checkout</code> <a href="https://svn.apache.org/repos/infra/websites/production/jspwiki/content/apidocs/">https://svn.apache.org/repos/infra/websites/production/jspwiki/content/apidocs/</a></p></li>
      <li>
      <p><code>svn add</code> javadocs directory/ies, which have been generated as part of the release (check for <code>*/target/apidocs</code> folders)</p></li>
      <li>
      <p>modify the three links on <a href="https://svn.apache.org/repos/infra/websites/production/jspwiki/content/apidocs/index.html">https://svn.apache.org/repos/infra/websites/production/jspwiki/content/apidocs/index.html</a> so they point to the new javadocs</p></li>
    </ol>
  </li>
  <li>
  <p><strong>Wait 24 hours for mirrors to sync</strong></p></li>
  <li>
  <p><strong>Post link to the full release notes</strong> along with links to the major JIRA changes <strong>on the front page of the site</strong></p></li>
</ol>
<h2>Announce the release<a name="announce-the-release"></a></h2>
<ol>
  <li>Send the following from an apache.org address to <a href="mailto:an&#110;o&#x75;&#110;c&#x65;&#64;&#x61;&#112;ache&#x2e;&#111;&#114;g">an&#110;o&#x75;&#110;c&#x65;&#64;&#x61;&#112;ache&#x2e;&#111;&#114;g</a>, <a href="mailto:&#117;s&#101;&#114;&#x40;&#106;&#115;&#x70;&#x77;&#x69;&#107;&#105;&#46;&#97;&#x70;&#97;&#99;&#x68;e&#x2e;&#111;r&#x67;">&#117;s&#101;&#114;&#x40;&#106;&#115;&#x70;&#x77;&#x69;&#107;&#105;&#46;&#97;&#x70;&#97;&#99;&#x68;e&#x2e;&#111;r&#x67;</a>, <a href="mailto:&#x64;&#101;&#x76;&#x40;&#106;&#115;&#x70;w&#105;&#107;&#x69;&#x2e;&#x61;&#x70;&#97;&#x63;&#104;e&#x2e;&#x6f;&#x72;&#103;">&#x64;&#101;&#x76;&#x40;&#106;&#115;&#x70;w&#105;&#107;&#x69;&#x2e;&#x61;&#x70;&#97;&#x63;&#104;e&#x2e;&#x6f;&#x72;&#103;</a>:
    <pre><code>Subject: [ANNOUNCE] Apache JSPWiki X.Y.Z released

The Apache JSPWiki team is pleased to announce the release of JSPWiki X.Y.Z.

This is the &lt;REPLACE&gt; release on the X.Y series of Apache JSPWiki, a feature-rich and 
extensible WikiWiki engine built around the standard JEE components.

The release is available here:
http://www.apache.org/dyn/closer.cgi/jspwiki/

JSPWiki Maven artifacts are available under org.apache.jspwiki groupId, 
version X.Y.Z

The full change log is available here:
https://issues.apache.org/jira/browse/JSPWIKI/fixforversion/&lt;REPLACE&gt;

A curated change log is also available here:
https://jspwiki-wiki.apache.org/Wiki.jsp?page=NewIn&lt;REPLACE&gt;

We welcome your help and feedback. For more information on how to
report problems, and to get involved visit the project website at
http://jspwiki.apache.org/

The Apache JSPWiki Team
</code></pre>
  </li>
</ol>
<h2>Add the next release version to JIRA<a name="add-the-next-release-version-to-jira"></a></h2>
<ol>
  <li>
  <p>Add the <a href="https://issues.apache.org/jira/plugins/servlet/project-config/JSPWIKI/versions">next version number to JIRA</a></p></li>
  <li>
  <p>Mark the released version as "released" with a release date</p></li>
</ol>
<h2>Troubleshooting<a name="troubleshooting"></a></h2>
<ol>
  <li>
    <p>Cygwin mixes Windows path with cygdrive, so <code>mvn release:prepare</code> fails on svn commit</p>
    <p>Current workaround: perform release vía <code>cmd.exe</code></p>
  </li>
  <li>
    <p>Avoid gpg signing prompt when using Maven release plugin</p>
    <p>See <a href="http://stackoverflow.com/q/14114528">http://stackoverflow.com/q/14114528</a></p>
  </li>
  <li>
    <p><code>mvn release:prepare</code> doesn't find <code>svn</code> credentials</p>
    <p>On your <code>settings.xml</code> file you should have one <code>&lt;server /&gt;</code> entry for each of the following ones:</p>
    <ul>
      <li><code>apache.snapshots.https</code>: to be able to deploy snapshots</li>
      <li><code>apache.releases.https</code>: to be able to deploy releases</li>
      <li><code>svn.apache.org</code>: to be able to create tags</li>
    </ul>
    <p>Alternatively, for the last one, you could pass <code>-Dusername=[username] -Dpassword=[password]</code> to the <code>mvn</code> command (source: <a href="http://stackoverflow.com/q/1255593">http://stackoverflow.com/q/1255593</a>)</p>
  </li>
  <li>
    <p>Release fails after a <code>tag</code> has been generated and the <code>pom</code> versions have been incremented</p>
    <p>No need of <code>mvn release:rollback</code>, instead check out the <code>tag</code> and <code>release:perform -DconnectionUrl=scm:svn:https://svn.apache.org/COMPLETE-URL-TO-TAG</code></p>
  </li>
</ol>
<h2>Other links of interest<a name="other-links-of-interest"></a></h2>
<ul>
  <li><a href="https://confluence.sakaiproject.org/display/REL/Maven+release+plugin+cheat+sheet">Maven release plugin cheat sheet</a></li>
  <li><a href="http://www.apache.org/dev/publishing-maven-artifacts.html#dev-env">Publishing Maven Artifacts - setup your development environment</a></li>
  <li><a href="http://maven.apache.org/maven-release/maven-release-plugin/">Maven release plugin</a></li>
  <li>Repository management with Nexus: <a href="http://books.sonatype.com/nexus-book/reference/staging-sect-intro.html">Chapter 11. Improved Releases with the Nexus Staging Suite</a></li>
</ul>
        </div>
        <div style="clear:both;"></div>
      </div>
      <div id="actionsBottom" class="pageactions"> 
        <a href="#top" class="action quick2top" title="Go to top">�</a>
      </div>

    </div>

    <div id="favorites">
      <div class="leftmenu">
<p><strong>General</strong></p>
<ul>
  <li><a href="/index.html">Home</a></li>
  <li><a href="/general/downloads.html">Downloads</a></li>
  <li><a href="/general/news.html">News</a></li>
  <li><a href="http://www.apache.org/licenses/" class="external">License</a></li>
</ul>

<p><strong>Documentation</strong></p>
<ul>
  <li><a href="https://jspwiki-wiki.apache.org" class="external">Wiki</a></li>
  <li><a href="https://jspwiki-wiki.apache.org/Wiki.jsp?page=Getting%20Started" class="external">Getting started</a></li>
</ul>

<p><strong>Community</strong></p>
<ul>
  <li><a href="https://jspwiki-wiki.apache.org/Wiki.jsp?page=Getting%20Involved" class="external">Getting Involved</a></li>
  <li><a href="/community/mailing_lists.html">Mailing Lists</a></li>
  <li><a href="/community/social_media.html">Social Media</a></li>
  <li><a href="https://issues.apache.org/jira/browse/JSPWIKI#selectedTab=com.atlassian.jira.plugin.system.project%3Aissues-panel" class="external">Issue Tracker</a></li>
  <li><a href="http://www.ecyrd.com/JSPWiki/" class="external">Legacy Site</a></li>
  <li><a href="/community/people.html">People</a></li>
</ul>

<p><strong>Development</strong></p>
<ul>
  <li><a href="https://git-wip-us.apache.org/repos/asf?p=jspwiki.git;a=summary" class="external">Browse Sources</a></li>
  <li><a href="/apidocs/index.html">JavaDocs</a></li>
  <li><a href="/development/source_and_guide.html">Get and Build Source</a></li>
  <li><a href="https://builds.apache.org/job/JSPWiki/" class="external">Jenkins CI</a></li>
  <li><a href="https://builds.apache.org/analysis/overview?id=org.apache.jspwiki%3Ajspwiki-builder" class="external">Sonar Analysis</a></li>
  <li><a href="/development/edit_website.html">Edit Website</a></li>
  <li><a href="https://git-wip-us.apache.org/repos/asf?p=jspwiki.git;a=blob;f=ChangeLog" class="external">Change Log</a></li>
</ul>

<p><strong>PMC</strong></p>
<ul>
  <li><a href="/pmc/how_to_release.html">How to Release</a></li>
  <li><a href="/pmc/board_reports.html">Board Reports</a></li>
</ul>

<p><strong>ASF</strong></p>
<ul>
  <li><a href="http://www.apache.org" class="external">Website</a></li>
  <li><a href="http://www.apache.org/foundation/contributing.html" class="external">Donations</a></li>
  <li><a href="http://www.apache.org/foundation/sponsorship.html" class="external">Sponsorship</a></li>
  <li><a href="http://www.apache.org/foundation/thanks.html" class="external">Thanks</a></li>
</ul>      </div>
      <div class="leftmenufooter">
        <br /><hr>
      </div>
      <div class="wikiversion">
JSPWiki v2.10.2      </div>  
    </div>

	<div class="clearbox"></div>
  </div>
 
  <div id="footer">
    <div class="copyright">
      Copyright &copy; 2017 The Apache Software Foundation, Licensed under 
      the <a href="http://www.apache.org/licenses/LICENSE-2.0" class="external">Apache License, Version 2.0</a>.
      <br />Apache and the Apache feather logo are trademarks of The Apache Software Foundation.
    </div>
  </div>
</div>
</body></html>