<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.9) on Wed Feb 24 06:57:53 UTC 2021 -->
<title>DefaultAuthenticationManager (Apache JSPWiki 2.11.0-SNAPSHOT API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2021-02-24">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.5.1.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="DefaultAuthenticationManager (Apache JSPWiki 2.11.0-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DefaultAuthenticationManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.apache.wiki.auth</a></div>
<h2 title="Class DefaultAuthenticationManager" class="title">Class DefaultAuthenticationManager</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.wiki.auth.DefaultAuthenticationManager</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../api/engine/Initializable.html" title="interface in org.apache.wiki.api.engine">Initializable</a></code>, <code><a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></code></dd>
</dl>
<hr>
<object type="image/svg+xml" data="DefaultAuthenticationManager.svg"  style="max-width:60%;float:right;"></object>
<pre style="white-space:pre-wrap;">public class <a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.64">DefaultAuthenticationManager</a>
extends java.lang.Object
implements <a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></pre>
<div class="block">Default implementation for <a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth"><code>AuthenticationManager</code></a>

 </div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2.3</dd>
</dl>
</li>
</ul>
</div>
<div class="summary" style="clear:right;">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#EMPTY_MAP">EMPTY_MAP</a></span></code></th>
<td class="colLast">
<div class="block">Empty Map passed to JAAS <a href="#doJAASLogin(java.lang.Class,javax.security.auth.callback.CallbackHandler,java.util.Map)"><code>doJAASLogin(Class, CallbackHandler, Map)</code></a> method.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected java.lang.Class&lt;? extends javax.security.auth.spi.LoginModule&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#m_loginModuleClass">m_loginModuleClass</a></span></code></th>
<td class="colLast">
<div class="block">Class (of type LoginModule) to use for custom authentication.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#m_loginModuleOptions">m_loginModuleOptions</a></span></code></th>
<td class="colLast">
<div class="block">Options passed to <code>LoginModule.initialize(Subject, CallbackHandler, Map, Map)</code>;
 initialized by <a href="#initialize(org.apache.wiki.api.core.Engine,java.util.Properties)"><code>initialize(Engine, Properties)</code></a>.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="fields.inherited.from.class.org.apache.wiki.auth.AuthenticationManager">
<!--   -->
</a>
<h3>Fields inherited from interface&nbsp;org.apache.wiki.auth.<a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></h3>
<code><a href="AuthenticationManager.html#PREFIX_LOGIN_MODULE_OPTIONS">PREFIX_LOGIN_MODULE_OPTIONS</a>, <a href="AuthenticationManager.html#PROP_ALLOW_COOKIE_ASSERTIONS">PROP_ALLOW_COOKIE_ASSERTIONS</a>, <a href="AuthenticationManager.html#PROP_ALLOW_COOKIE_AUTH">PROP_ALLOW_COOKIE_AUTH</a>, <a href="AuthenticationManager.html#PROP_LOGIN_MODULE">PROP_LOGIN_MODULE</a>, <a href="AuthenticationManager.html#PROP_LOGIN_THROTTLING">PROP_LOGIN_THROTTLING</a>, <a href="AuthenticationManager.html#PROP_STOREIPADDRESS">PROP_STOREIPADDRESS</a></code></li>
</ul>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">DefaultAuthenticationManager</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addWikiEventListener(org.apache.wiki.event.WikiEventListener)">addWikiEventListener</a></span>&#8203;(<a href="../event/WikiEventListener.html" title="interface in org.apache.wiki.event">WikiEventListener</a>&nbsp;listener)</code></th>
<td class="colLast">
<div class="block">Registers a WikiEventListener with this instance.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#allowsCookieAssertions()">allowsCookieAssertions</a></span>()</code></th>
<td class="colLast">
<div class="block">Determines whether this Engine allows users to assert identities using cookies instead of passwords.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#allowsCookieAuthentication()">allowsCookieAuthentication</a></span>()</code></th>
<td class="colLast">
<div class="block">Determines whether this Engine allows users to authenticate using cookies instead of passwords.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>java.util.Set&lt;java.security.Principal&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#doJAASLogin(java.lang.Class,javax.security.auth.callback.CallbackHandler,java.util.Map)">doJAASLogin</a></span>&#8203;(java.lang.Class&lt;? extends javax.security.auth.spi.LoginModule&gt;&nbsp;clazz,
           javax.security.auth.callback.CallbackHandler&nbsp;handler,
           java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;options)</code></th>
<td class="colLast">
<div class="block">Instantiates and executes a single JAAS <code>LoginModule</code>, and returns a Set of Principals that results from a successful login.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initialize(org.apache.wiki.api.core.Engine,java.util.Properties)">initialize</a></span>&#8203;(<a href="../api/core/Engine.html" title="interface in org.apache.wiki.api.core">Engine</a>&nbsp;engine,
          java.util.Properties&nbsp;props)</code></th>
<td class="colLast">
<div class="block">Initializes this Engine component.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isContainerAuthenticated()">isContainerAuthenticated</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns true if this Engine uses container-managed authentication.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#login(javax.servlet.http.HttpServletRequest)">login</a></span>&#8203;(javax.servlet.http.HttpServletRequest&nbsp;request)</code></th>
<td class="colLast">
<div class="block">Logs in the user by attempting to populate a Session Subject from a web servlet request by examining the request
  for the presence of container credentials and user cookies.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#login(org.apache.wiki.api.core.Session,javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String)">login</a></span>&#8203;(<a href="../api/core/Session.html" title="interface in org.apache.wiki.api.core">Session</a>&nbsp;session,
     javax.servlet.http.HttpServletRequest&nbsp;request,
     java.lang.String&nbsp;username,
     java.lang.String&nbsp;password)</code></th>
<td class="colLast">
<div class="block">Attempts to perform a Session login for the given username/password combination using JSPWiki's custom authentication mode.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#logout(javax.servlet.http.HttpServletRequest)">logout</a></span>&#8203;(javax.servlet.http.HttpServletRequest&nbsp;request)</code></th>
<td class="colLast">
<div class="block">Logs the user out by retrieving the Session associated with the HttpServletRequest and unbinding all of the Subject's Principals,
 except for <a href="authorize/Role.html#ALL"><code>Role.ALL</code></a>, <a href="authorize/Role.html#ANONYMOUS"><code>Role.ANONYMOUS</code></a>. is a cheap-and-cheerful way to do it without invoking JAAS LoginModules.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#removeWikiEventListener(org.apache.wiki.event.WikiEventListener)">removeWikiEventListener</a></span>&#8203;(<a href="../event/WikiEventListener.html" title="interface in org.apache.wiki.event">WikiEventListener</a>&nbsp;listener)</code></th>
<td class="colLast">
<div class="block">Un-registers a WikiEventListener with this instance.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.org.apache.wiki.auth.AuthenticationManager">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.apache.wiki.auth.<a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></h3>
<code><a href="AuthenticationManager.html#fireEvent(int,java.security.Principal,java.lang.Object)">fireEvent</a>, <a href="AuthenticationManager.html#getLoginPrincipal(java.util.Set)">getLoginPrincipal</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="EMPTY_MAP">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>EMPTY_MAP</h4>
<pre>protected static final&nbsp;java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt; <a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.74">EMPTY_MAP</a></pre>
<div class="block">Empty Map passed to JAAS <a href="#doJAASLogin(java.lang.Class,javax.security.auth.callback.CallbackHandler,java.util.Map)"><code>doJAASLogin(Class, CallbackHandler, Map)</code></a> method.</div>
</li>
</ul>
<a id="m_loginModuleClass">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>m_loginModuleClass</h4>
<pre>protected&nbsp;java.lang.Class&lt;? extends javax.security.auth.spi.LoginModule&gt; <a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.77">m_loginModuleClass</a></pre>
<div class="block">Class (of type LoginModule) to use for custom authentication.</div>
</li>
</ul>
<a id="m_loginModuleOptions">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>m_loginModuleOptions</h4>
<pre>protected&nbsp;java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt; <a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.81">m_loginModuleOptions</a></pre>
<div class="block">Options passed to <code>LoginModule.initialize(Subject, CallbackHandler, Map, Map)</code>;
 initialized by <a href="#initialize(org.apache.wiki.api.core.Engine,java.util.Properties)"><code>initialize(Engine, Properties)</code></a>.</div>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DefaultAuthenticationManager</h4>
<pre>public&nbsp;<a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.64">DefaultAuthenticationManager</a>()</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="initialize(org.apache.wiki.api.core.Engine,java.util.Properties)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initialize</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;<a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.108">initialize</a>&#8203;(<a href="../api/core/Engine.html" title="interface in org.apache.wiki.api.core">Engine</a>&nbsp;engine,
                       java.util.Properties&nbsp;props)
                throws <a href="../api/exceptions/WikiException.html" title="class in org.apache.wiki.api.exceptions">WikiException</a></pre>
<div class="block"><p>Initializes this Engine component. Note that the engine is not fully initialized at this
 point, so don't do anything fancy here - use lazy init, if you have to.<br/>&nbsp;</p></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../api/engine/Initializable.html#initialize(org.apache.wiki.api.core.Engine,java.util.Properties)">initialize</a></code>&nbsp;in interface&nbsp;<code><a href="../api/engine/Initializable.html" title="interface in org.apache.wiki.api.engine">Initializable</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>engine</code> - Engine performing the initialization.</dd>
<dd><code>props</code> - Properties for setup.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../api/exceptions/WikiException.html" title="class in org.apache.wiki.api.exceptions">WikiException</a></code> - if an exception occurs while initializing the component.</dd>
</dl>
</li>
</ul>
<a id="isContainerAuthenticated()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isContainerAuthenticated</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.138">isContainerAuthenticated</a>()</pre>
<div class="block">Returns true if this Engine uses container-managed authentication. This method is used primarily for cosmetic purposes in the
 JSP tier, and performs no meaningful security function per se. Delegates to
 <a href="authorize/WebContainerAuthorizer.html#isContainerAuthorized()"><code>WebContainerAuthorizer.isContainerAuthorized()</code></a>,
 if used as the external authorizer; otherwise, returns <code>false</code>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AuthenticationManager.html#isContainerAuthenticated()">isContainerAuthenticated</a></code>&nbsp;in interface&nbsp;<code><a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if the wiki's authentication is managed by the container, <code>false</code> otherwise</dd>
</dl>
</li>
</ul>
<a id="login(javax.servlet.http.HttpServletRequest)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>login</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.154">login</a>&#8203;(javax.servlet.http.HttpServletRequest&nbsp;request)
              throws <a href="WikiSecurityException.html" title="class in org.apache.wiki.auth">WikiSecurityException</a></pre>
<div class="block"><p>Logs in the user by attempting to populate a Session Subject from a web servlet request by examining the request
  for the presence of container credentials and user cookies. The processing logic is as follows:
 </p>
 <ul>
 <li>If the Session had previously been unauthenticated, check to see if user has subsequently authenticated. To be considered
 "authenticated," the request must supply one of the following (in order of preference): the container <code>userPrincipal</code>,
 container <code>remoteUser</code>, or authentication cookie. If the user is authenticated, this method fires event
 <a href="../event/WikiSecurityEvent.html#LOGIN_AUTHENTICATED"><code>WikiSecurityEvent.LOGIN_AUTHENTICATED</code></a> with two parameters: a Principal representing the login principal,
 and the current Session. In addition, if the authorizer is of type WebContainerAuthorizer, this method iterates through the
 container roles returned by <a href="authorize/WebContainerAuthorizer.html#getRoles()"><code>WebContainerAuthorizer.getRoles()</code></a>, tests for membership in each
 one, and adds those that pass to the Subject's principal set.</li>
 <li>If, after checking for authentication, the Session is still Anonymous, this method next checks to see if the user has
 "asserted" an identity by supplying an assertion cookie. If the user is found to be asserted, this method fires event
 <a href="../event/WikiSecurityEvent.html#LOGIN_ASSERTED"><code>WikiSecurityEvent.LOGIN_ASSERTED</code></a> with two parameters: <code>WikiPrincipal(<em>cookievalue</em>)</code>,
 and the current Session.</li>
 <li>If, after checking for authenticated and asserted status, the  Session is <em>still</em> anonymous, this method fires event
 <a href="../event/WikiSecurityEvent.html#LOGIN_ANONYMOUS"><code>WikiSecurityEvent.LOGIN_ANONYMOUS</code></a> with two parameters: <code>WikiPrincipal(<em>remoteAddress</em>)</code>,
 and the current Session </li>
 </ul></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AuthenticationManager.html#login(javax.servlet.http.HttpServletRequest)">login</a></code>&nbsp;in interface&nbsp;<code><a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>request</code> - servlet request for this user</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>always returns <code>true</code> (because anonymous login, at least, will always succeed)</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="WikiSecurityException.html" title="class in org.apache.wiki.auth">WikiSecurityException</a></code> - if the user cannot be logged in for any reason</dd>
</dl>
</li>
</ul>
<a id="login(org.apache.wiki.api.core.Session,javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>login</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.211">login</a>&#8203;(<a href="../api/core/Session.html" title="interface in org.apache.wiki.api.core">Session</a>&nbsp;session,
                     javax.servlet.http.HttpServletRequest&nbsp;request,
                     java.lang.String&nbsp;username,
                     java.lang.String&nbsp;password)
              throws <a href="WikiSecurityException.html" title="class in org.apache.wiki.auth">WikiSecurityException</a></pre>
<div class="block">Attempts to perform a Session login for the given username/password combination using JSPWiki's custom authentication mode. In
 order to log in, the JAAS LoginModule supplied by the Engine property <a href="AuthenticationManager.html#PROP_LOGIN_MODULE"><code>AuthenticationManager.PROP_LOGIN_MODULE</code></a> will be instantiated, and its
 <code>LoginModule.initialize(Subject, CallbackHandler, Map, Map)</code> method will be invoked. By default,
 the <a href="login/UserDatabaseLoginModule.html" title="class in org.apache.wiki.auth.login"><code>UserDatabaseLoginModule</code></a> class will be used. When the LoginModule's <code>initialize</code>
 method is invoked, an options Map populated by properties keys prefixed by <a href="AuthenticationManager.html#PREFIX_LOGIN_MODULE_OPTIONS"><code>AuthenticationManager.PREFIX_LOGIN_MODULE_OPTIONS</code></a> will be passed as a
 parameter.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AuthenticationManager.html#login(org.apache.wiki.api.core.Session,javax.servlet.http.HttpServletRequest,java.lang.String,java.lang.String)">login</a></code>&nbsp;in interface&nbsp;<code><a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>session</code> - the current wiki session; may not be <code>null</code>.</dd>
<dd><code>request</code> - the user's HTTP request. This parameter may be <code>null</code>, but the configured LoginModule will not have access
                to the HTTP request in this case.</dd>
<dd><code>username</code> - The user name. This is a login name, not a WikiName. In most cases they are the same, but in some cases, they might not be.</dd>
<dd><code>password</code> - the password</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true, if the username/password is valid</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="WikiSecurityException.html" title="class in org.apache.wiki.auth">WikiSecurityException</a></code> - if the Authorizer or UserManager cannot be obtained</dd>
</dl>
</li>
</ul>
<a id="logout(javax.servlet.http.HttpServletRequest)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logout</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;<a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.267">logout</a>&#8203;(javax.servlet.http.HttpServletRequest&nbsp;request)</pre>
<div class="block">Logs the user out by retrieving the Session associated with the HttpServletRequest and unbinding all of the Subject's Principals,
 except for <a href="authorize/Role.html#ALL"><code>Role.ALL</code></a>, <a href="authorize/Role.html#ANONYMOUS"><code>Role.ANONYMOUS</code></a>. is a cheap-and-cheerful way to do it without invoking JAAS LoginModules.
 The logout operation will also flush the JSESSIONID cookie from the user's browser session, if it was set.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AuthenticationManager.html#logout(javax.servlet.http.HttpServletRequest)">logout</a></code>&nbsp;in interface&nbsp;<code><a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>request</code> - the current HTTP request</dd>
</dl>
</li>
</ul>
<a id="allowsCookieAssertions()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>allowsCookieAssertions</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.299">allowsCookieAssertions</a>()</pre>
<div class="block">Determines whether this Engine allows users to assert identities using cookies instead of passwords. This is determined by inspecting
 the Engine property <a href="AuthenticationManager.html#PROP_ALLOW_COOKIE_ASSERTIONS"><code>AuthenticationManager.PROP_ALLOW_COOKIE_ASSERTIONS</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AuthenticationManager.html#allowsCookieAssertions()">allowsCookieAssertions</a></code>&nbsp;in interface&nbsp;<code><a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if cookies are allowed</dd>
</dl>
</li>
</ul>
<a id="allowsCookieAuthentication()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>allowsCookieAuthentication</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.307">allowsCookieAuthentication</a>()</pre>
<div class="block">Determines whether this Engine allows users to authenticate using cookies instead of passwords. This is determined by inspecting
 the Engine property <a href="AuthenticationManager.html#PROP_ALLOW_COOKIE_AUTH"><code>AuthenticationManager.PROP_ALLOW_COOKIE_AUTH</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AuthenticationManager.html#allowsCookieAuthentication()">allowsCookieAuthentication</a></code>&nbsp;in interface&nbsp;<code><a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if cookies are allowed for authentication</dd>
</dl>
</li>
</ul>
<a id="doJAASLogin(java.lang.Class,javax.security.auth.callback.CallbackHandler,java.util.Map)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doJAASLogin</h4>
<pre class="methodSignature">public&nbsp;java.util.Set&lt;java.security.Principal&gt;&nbsp;<a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.315">doJAASLogin</a>&#8203;(java.lang.Class&lt;? extends javax.security.auth.spi.LoginModule&gt;&nbsp;clazz,
                                                          javax.security.auth.callback.CallbackHandler&nbsp;handler,
                                                          java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;options)
                                                   throws <a href="WikiSecurityException.html" title="class in org.apache.wiki.auth">WikiSecurityException</a></pre>
<div class="block">Instantiates and executes a single JAAS <code>LoginModule</code>, and returns a Set of Principals that results from a successful login.
 The LoginModule is instantiated, then its <code>LoginModule.initialize(Subject, CallbackHandler, Map, Map)</code> method is called. The
 parameters passed to <code>initialize</code> is a dummy Subject, an empty shared-state Map, and an options Map the caller supplies.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AuthenticationManager.html#doJAASLogin(java.lang.Class,javax.security.auth.callback.CallbackHandler,java.util.Map)">doJAASLogin</a></code>&nbsp;in interface&nbsp;<code><a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>clazz</code> - the LoginModule class to instantiate</dd>
<dd><code>handler</code> - the callback handler to supply to the LoginModule</dd>
<dd><code>options</code> - a Map of key/value strings for initializing the LoginModule</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the set of Principals returned by the JAAS method <code>Subject.getPrincipals()</code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="WikiSecurityException.html" title="class in org.apache.wiki.auth">WikiSecurityException</a></code> - if the LoginModule could not be instantiated for any reason</dd>
</dl>
</li>
</ul>
<a id="addWikiEventListener(org.apache.wiki.event.WikiEventListener)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addWikiEventListener</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;<a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.355">addWikiEventListener</a>&#8203;(<a href="../event/WikiEventListener.html" title="interface in org.apache.wiki.event">WikiEventListener</a>&nbsp;listener)</pre>
<div class="block">Registers a WikiEventListener with this instance. This is a convenience method.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AuthenticationManager.html#addWikiEventListener(org.apache.wiki.event.WikiEventListener)">addWikiEventListener</a></code>&nbsp;in interface&nbsp;<code><a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>listener</code> - the event listener</dd>
</dl>
</li>
</ul>
<a id="removeWikiEventListener(org.apache.wiki.event.WikiEventListener)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>removeWikiEventListener</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;<a href="../../../../src-html/org/apache/wiki/auth/DefaultAuthenticationManager.html#line.363">removeWikiEventListener</a>&#8203;(<a href="../event/WikiEventListener.html" title="interface in org.apache.wiki.event">WikiEventListener</a>&nbsp;listener)</pre>
<div class="block">Un-registers a WikiEventListener with this instance. This is a convenience method.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="AuthenticationManager.html#removeWikiEventListener(org.apache.wiki.event.WikiEventListener)">removeWikiEventListener</a></code>&nbsp;in interface&nbsp;<code><a href="AuthenticationManager.html" title="interface in org.apache.wiki.auth">AuthenticationManager</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>listener</code> - the event listener</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DefaultAuthenticationManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright © 2001-2021 The Apache Software Foundation. All rights reserved.</small></p>
</footer>
</body>
</html>